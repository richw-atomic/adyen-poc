{
	"info": {
		"_postman_id": "6e8ddd50-59a7-44a6-ac8b-4e6a825b5c8f",
		"name": "Adyen POC",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "8406043",
		"_collection_link": "https://www.postman.com/extreamapp/workspace/atomic-adyen/collection/8406043-6e8ddd50-59a7-44a6-ac8b-4e6a825b5c8f?action=share&source=collection_link&creator=8406043"
	},
	"item": [
		{
			"name": "Orders",
			"item": [
				{
					"name": "Create Order",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const jsonData = pm.response.json();",
									"if (jsonData && jsonData.orderId) {",
									"    pm.collectionVariables.set(\"orderId\", jsonData.orderId);",
									"    console.log(\"Collection variable 'orderId' set to:\", jsonData.orderId);",
									"} else {",
									"    console.log(\"Could not find 'orderId' in the response.\");",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"amount\": {\n    \"value\": {{amount}},\n    \"currency\": \"{{currency}}\"\n  }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/orders",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"orders"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Payment Methods",
			"item": [
				{
					"name": "Fetch Payment Methods",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"amount\": {\n    \"value\": {{amount}},\n    \"currency\": \"{{currency}}\"\n  }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/payment-methods",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"payment-methods"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Payments",
			"item": [
				{
					"name": "Make Payment",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const jsonData = pm.response.json();",
									"if (jsonData && jsonData.paymentId) {",
									"    pm.collectionVariables.set(\"paymentId\", jsonData.orderId);",
									"    console.log(\"Collection variable 'paymentId' set to:\", jsonData.paymentId);",
									"} else {",
									"    console.log(\"Could not find 'paymentId' in the response.\");",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"orderId\": \"{{orderId}}\",\n    \"amount\": {\n        \"value\": {{amount}},\n        \"currency\": \"{{currency}}\"\n    },\n    \"paymentMethod\": {\n        \"type\": \"scheme\",\n        \"encryptedCardNumber\": \"test_4917610000000000\",\n        \"encryptedExpiryMonth\": \"test_03\",\n        \"encryptedExpiryYear\": \"test_2030\",\n        \"encryptedSecurityCode\": \"test_737\",\n        \"brand\": \"visa\",\n        \"checkoutAttemptId\": \"do-not-track\"\n    },\n    \"browserInfo\": {\n        \"userAgent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36\",\n        \"acceptHeader\": \"application/json, text/plain, */*\",\n        \"language\": \"en-GB\",\n        \"screenWidth\": 1710,\n        \"screenHeight\": 1112,\n        \"timeZoneOffset\": -60,\n        \"colorDepth\": 30,\n        \"javaEnabled\": false\n    },\n    \"returnUrl\": \"{{baseUrl}}/\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/payments",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"payments"
							]
						}
					},
					"response": [
						{
							"name": "Make Payment",
							"originalRequest": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"orderId\": \"{{orderId}}\",\n    \"amount\": {\n        \"value\": {{amount}},\n        \"currency\": \"{{currency}}\"\n    },\n    \"paymentMethod\": {\n        \"type\": \"scheme\",\n        \"encryptedCardNumber\": \"test_4917610000000000\",\n        \"encryptedExpiryMonth\": \"test_03\",\n        \"encryptedExpiryYear\": \"test_2030\",\n        \"encryptedSecurityCode\": \"test_737\",\n        \"brand\": \"visa\",\n        \"checkoutAttemptId\": \"do-not-track\"\n    },\n    \"returnUrl\": \"cp-app://payment-success\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/payments",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"payments"
									]
								}
							},
							"_postman_previewlanguage": "",
							"header": [],
							"cookie": [
								{
									"expires": "Invalid Date"
								}
							],
							"body": ""
						}
					]
				},
				{
					"name": "Submit Payment Details (POST)",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\"details\":{\"threeDSResult\":\"3DSResult\"}}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/payments/details/:paymentId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"payments",
								"details",
								":paymentId"
							],
							"variable": [
								{
									"key": "paymentId",
									"value": "{{paymentId}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Submit Payment Details (Session)",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\"details\":{\"redirectResult\":\"<REDIRECT_RESULT>\"}}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/payments/details/session/:sessionId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"payments",
								"details",
								"session",
								":sessionId"
							],
							"variable": [
								{
									"key": "sessionId",
									"value": "{{sessionId}}"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Sessions",
			"item": [
				{
					"name": "Create Session",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const jsonData = pm.response.json();",
									"if (jsonData && jsonData.id) {",
									"    pm.collectionVariables.set(\"sessionId\", jsonData.id);",
									"    console.log(\"Collection variable 'sessionId' set to:\", jsonData.id);",
									"} else {",
									"    console.log(\"Could not find 'id' in the response.\");",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"amount\": {\n    \"value\": {{amount}},\n    \"currency\": \"{{currency}}\"\n  },\n \"path\": \"sessions-dropin\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/sessions",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"sessions"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Webhooks",
			"item": [
				{
					"name": "Adyen Webhook Notification",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"live\": \"false\",\n  \"notificationItems\": [\n    {\n      \"NotificationRequestItem\": {\n        \"additionalData\": {\n          \"hmacSignature\": \"<HMAC_SIGNATURE>\"\n        },\n        \"amount\": {\n          \"currency\": \"USD\",\n          \"value\": 10000\n        },\n        \"eventCode\": \"AUTHORISATION\",\n        \"eventDate\": \"2025-07-06T12:00:00Z\",\n        \"merchantAccountCode\": \"<YOUR_MERCHANT_ACCOUNT>\",\n        \"merchantReference\": \"<PAYMENT_MERCHANT_REFERENCE>\",\n        \"paymentMethod\": \"visa\",\n        \"pspReference\": \"<PSP_REFERENCE>\",\n        \"reason\": \"\",\n        \"success\": \"true\"\n      }\n    }\n  ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/webhooks",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"webhooks"
							]
						}
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:3000"
		},
		{
			"key": "orderId",
			"value": ""
		},
		{
			"key": "amount",
			"value": "100",
			"type": "string"
		},
		{
			"key": "currency",
			"value": "GBP",
			"type": "string"
		},
		{
			"key": "paymentId",
			"value": ""
		},
		{
			"key": "sessionId",
			"value": ""
		}
	]
}